#  SauceDemo E2E & API Test Automation

Proyecto de automatizaci√≥n de pruebas E2E para SauceDemo y pruebas de API para Demoblaze utilizando Playwright con TypeScript y Page Object Model (POM).
Adem√°s se utiliza .env para manejo de data sensible y compatibilidad con reportes de Allure.

## Descripci√≥n

Este proyecto incluye dos tipos de automatizaci√≥n:

1. **Pruebas E2E** - Automatiza el flujo completo de compra en [SauceDemo](https://www.saucedemo.com/)
2. **Pruebas de API** - Valida endpoints REST de [Demoblaze API](https://api.demoblaze.com/) para registro y autenticaci√≥n

###  Caracter√≠sticas principales

-  **Selecci√≥n din√°mica de productos** - Los productos se extraen autom√°ticamente de la p√°gina web
-  **Page Object Model (POM)** - Arquitectura modular y mantenible  
-  **Pruebas de API REST** - Validaci√≥n completa de endpoints con TypeScript
-  **Constantes organizadas** - Enums y constantes centralizadas por funcionalidad
-  **TypeScript** - Tipado fuerte para mayor confiabilidad
-  **Validaciones robustas** - Verificaciones exhaustivas en cada paso
-  **Test Steps detallados** - Estructura BDD con `test.step()` para mejor trazabilidad
-  **Reportes detallados** - M√∫ltiples formatos de reportes disponibles
-  **Allure Reports** - Reportes avanzados con gr√°ficos y m√©tricas

##  Pasos para ejecuci√≥n desde 0

###  Prerrequisitos

- **Node.js** (versi√≥n 18 o superior)
- **Git** (opcional, para clonar el repositorio)
- **VS Code** (recomendado para desarrollo)

###  Instalaci√≥n

#### 1. Clonar o descargar el proyecto
```bash
# Si tienes Git instalado
git clone <url-del-repositorio> //TODO cambiar
cd reto_pichincha

# O simplemente descarga y extrae el ZIP del proyecto
```

#### 2. Instalar dependencias del proyecto
```bash
# Instalar todas las dependencias
npm install
```

#### 3. Instalar Playwright y navegadores
```bash
# Instalar Playwright CLI globalmente (opcional pero recomendado)
npm install -g @playwright/test

# Instalar los navegadores necesarios
npx playwright install

# Alternativamente, instalar solo navegadores espec√≠ficos
npx playwright install chromium firefox webkit
```

#### 4. Verificar la instalaci√≥n
```bash
# Verificar que Playwright est√° correctamente instalado
npx playwright --version
```

###  Configuraci√≥n

El proyecto incluye configuraci√≥n predefinida en `playwright.config.ts` con:
- M√∫ltiples navegadores (Chromium, Firefox, WebKit)
- Configuraci√≥n de timeouts optimizada
- Reportes en m√∫ltiples formatos
- Screenshots y videos en caso de fallos

##  Comandos de Ejecuci√≥n

### üì¶ **Scripts NPM Personalizados**

El proyecto incluye scripts predefinidos en `package.json` para facilitar la ejecuci√≥n:

```bash
# Ejecutar todas las pruebas (equivale a npx playwright test)
npm run test

# Ejecutar pruebas y generar reporte HTML autom√°ticamente
npm run test:report

# Generar reporte Allure ligero en un solo archivo
npm run allure:reportlite

# Generar reporte Allure completo y abrirlo autom√°ticamente
npm run allure:report
```

**üìã Detalles de los scripts:**

- **`npm run test`** - Ejecuta todas las pruebas usando Playwright
- **`npm run test:report`** - Ejecuta las pruebas, genera reporte HTML y lo abre autom√°ticamente
- **`npm run allure:reportlite`** - Genera un reporte Allure en un solo archivo (ideal para compartir)
- **`npm run allure:report`** - Genera reporte Allure completo en carpeta y lo abre en el navegador

###  Ejecuci√≥n B√°sica

```bash
# Ejecutar todas las pruebas (E2E + API)
npx playwright test

# Ejecutar solo pruebas E2E
npx playwright test tests/flujo_reto_tecnico.spec.ts

# Ejecutar solo pruebas de API
npx playwright test tests/reto_tecnico.api.spec.ts --project=api-tests

# Ejecutar pruebas en modo headed (ver navegador)
npx playwright test --headed

# Ejecutar con interfaz gr√°fica interactiva
npx playwright test --ui
```

###  Navegadores Espec√≠ficos

```bash
# Ejecutar solo en Chromium
npx playwright test --project=chromium

# Ejecutar solo en Firefox
npx playwright test --project=firefox

# Ejecutar solo en WebKit (Safari)
npx playwright test --project=webkit

# Ejecutar en todos los navegadores
npx playwright test --project=chromium --project=firefox --project=webkit
```

###  Reportes

####  Reporte HTML Nativo de Playwright
```bash
# Ejecutar con reporte HTML detallado
npx playwright test --reporter=html

# Ejecutar con reporte en l√≠nea simple
npx playwright test --reporter=line

# Ejecutar con m√∫ltiples reportes
npx playwright test --reporter=html,line

# Abrir el √∫ltimo reporte HTML generado
npx playwright show-report
```

####  Reportes Allure (Avanzados)

**Allure** proporciona reportes m√°s avanzados con gr√°ficos, m√©tricas detalladas y mejor visualizaci√≥n de resultados.

```bash
# ============ COMANDOS DIRECTOS ALTERNATIVOS ============
# Ejecutar pruebas y generar datos para Allure
npx playwright test --reporter=allure-playwright

# Generar reporte Allure sin instalar Allure localmente
allure generate --single-file allure-results

# Abrir reporte Allure ya generado
allure open allure-report

# Generar y servir reporte en una sola l√≠nea
allure serve allure-results
```

> **üí° Tip:** Se recomienda usar los scripts de npm (`npm run allure:reportlite`) 
> ya que simplifican el proceso.

** Caracter√≠sticas de Allure Reports:**
-  Gr√°ficos de tendencias y m√©tricas
-  Historial de ejecuciones
-  Detalles granulares de cada test
-  Screenshots autom√°ticos en fallos
-  Videos de ejecuci√≥n
-  An√°lisis de duraci√≥n y performance


## üìÅ Estructura del Proyecto

```
üì¶ reto_pichincha/
‚îú‚îÄ‚îÄ üìÇ src/
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ data/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ test-data.ts              # Datos de prueba centralizados
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ interfaces/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ user-data.interface.ts    # Interfaces TypeScript
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ pages/                        # Page Object Model
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ index.ts                  # Exportaciones centralizadas
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ login.page.ts             # P√°gina de login
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ inventory.page.ts         # P√°gina de inventario
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ cart.page.ts              # P√°gina de carrito
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ checkout-information-step-one.page.ts  # Informaci√≥n checkout
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ checkout-overview-step-two.page.ts     # Resumen checkout
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ checkout-complete.page.ts # Confirmaci√≥n final
‚îÇ   ‚îî‚îÄ‚îÄ üìÇ utils/
‚îÇ       ‚îî‚îÄ‚îÄ üìÇ constants/                #  Constantes organizadas por funcionalidad
‚îÇ           ‚îú‚îÄ‚îÄ üìÑ api-urls.constants.ts      # URLs de API endpoints
‚îÇ           ‚îú‚îÄ‚îÄ üìÑ api-messages.constants.ts  # Mensajes, status codes y validaciones
‚îÇ           ‚îú‚îÄ‚îÄ üìÑ api-users.constants.ts     # Usuarios y credenciales para API
‚îÇ           ‚îú‚îÄ‚îÄ üìÑ index.ts              # Exportaciones de constantes
‚îÇ           ‚îî‚îÄ‚îÄ üìÑ messages.constants.ts # Constantes de mensajes E2E
‚îú‚îÄ‚îÄ üìÇ tests/
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ helpers/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ sauce-demo-fixture.ts     # Fixtures personalizadas
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ flujo_reto_tecnico.spec.ts    #  Test principal E2E (SauceDemo)
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ reto_tecnico.api.spec.ts      #  Tests de API REST (Demoblaze)
‚îú‚îÄ‚îÄ üìÇ test-results/                     # Resultados de pruebas
‚îú‚îÄ‚îÄ üìÇ playwright-report/                # Reportes HTML nativos
‚îú‚îÄ‚îÄ üìÇ allure-results/                   # Datos para Allure
‚îú‚îÄ‚îÄ üìÇ allure-report/                    # Reportes Allure generados
‚îú‚îÄ‚îÄ üìÑ playwright.config.ts              # Configuraci√≥n Playwright
‚îú‚îÄ‚îÄ üìÑ package.json                      # Dependencias del proyecto
‚îî‚îÄ‚îÄ üìÑ README.md                         # Este archivo
```

##  Escenarios de Prueba

###  Historia de Usuario E2E (SauceDemo)
```gherkin
Feature: Flujo de compra en SauceDemo
  Como usuario de SauceDemo
  Quiero realizar un proceso de compra
  Para validar que el flujo E2E funciona correctamente

Scenario: Completar compra con 2 productos aleatorios
  Given el usuario se encuentra autenticado con credenciales v√°lidas
  When agrega 2 productos aleatorios al carrito de compra
  Then el contador del carrito deber√≠a reflejar la cantidad de productos agregados
  When completa el formulario de compra con datos aleatorios y finaliza la compra
  Then deber√≠a visualizar el mensaje de confirmaci√≥n "THANK YOU FOR YOUR ORDER"
```

###  üîó Historia de Usuario API (Demoblaze)
```gherkin
Feature: Validaci√≥n de API REST para Demoblaze
  Como QA Automatizador de pruebas
  Quiero validar las funcionalidades de la API de Demoblaze
  Para asegurar que los endpoints de registro y autenticaci√≥n funcionan correctamente

Scenario: Registro exitoso de nuevo usuario
  When env√≠o una petici√≥n POST al endpoint de registro con credenciales nuevas y v√°lidas
  Then deber√≠a recibir un status 200 y un cuerpo de respuesta vac√≠o

Scenario: Validaci√≥n de usuario existente
  When intento registrar un usuario ya registrado
  Then deber√≠a recibir un mensaje de error notificando que el usuario ya existe

Scenario: Autenticaci√≥n con credenciales v√°lidas
  When env√≠o una petici√≥n POST al endpoint de login con credenciales v√°lidas
  Then deber√≠a recibir un token de autenticaci√≥n v√°lido

Scenario: Autenticaci√≥n con credenciales inv√°lidas
  When env√≠o una petici√≥n POST al endpoint de login con credenciales inv√°lidas
  Then deber√≠a recibir un mensaje de error
```

###  üìã Pasos del Test E2E

1. ** Autenticaci√≥n** - Login con credenciales v√°lidas
2. ** Selecci√≥n de productos** - Agregar 2 productos aleatorios
3. ** Validaci√≥n de carrito** - Verificar productos agregados
4. ** Checkout informaci√≥n** - Completar datos personales
5. ** Revisi√≥n de pedido** - Validar resumen y totales
6. ** Confirmaci√≥n** - Finalizar compra y validar mensaje

###  üîó Endpoints de API Validados

| Endpoint | M√©todo | Descripci√≥n | Validaciones |
|----------|--------|-------------|--------------|
| `/signup` | POST | Registro de usuario | Status 200, cuerpo vac√≠o, sin errorMessage |
| `/signup` | POST | Usuario existente | Status 200, errorMessage presente |
| `/login` | POST | Login v√°lido | Status 200, token v√°lido, sin errorMessage |
| `/login` | POST | Login inv√°lido | Status 200, errorMessage presente |

##  üÜï Mejoras Implementadas en API

### **Estructura BDD con test.step()**

Cada test utiliza `test.step()` para mejor trazabilidad y reportes:

```typescript
test('Validar el registro exitoso de un nuevo usuario', async ({ request }) => {
  await test.step('When env√≠o una petici√≥n POST al endpoint de registro', async () => {
    // L√≥gica de la petici√≥n
  });

  await test.step('Then deber√≠a recibir un status 200 y cuerpo vac√≠o', async () => {
    // Validaciones
  });
});
```

##  Configuraci√≥n Avanzada

###  Variables de Entorno

Crea un archivo `.env` en la ra√≠z del proyecto:

> **‚ö†Ô∏è IMPORTANTE - Seguridad del archivo .env:**
> 
> Por efectos pr√°cticos y did√°cticos, el archivo `.env` se incluye en este repositorio. 
> Sin embargo, **en un caso realista y en proyectos de producci√≥n**, este archivo **NO se debe subir** 
> al repositorio y debe estar incluido en el archivo `.gitignore` para proteger informaci√≥n sensible 
> como credenciales, URLs de entornos privados, tokens de API, etc.
> 
> ```bash
> # Ejemplo de .gitignore para proyectos reales
> .env
> .env.production
> ```

##  Recursos Adicionales

- [ Documentaci√≥n oficial de Playwright](https://playwright.dev/)
- [ Gu√≠a de Page Object Model](https://playwright.dev/docs/pom)
- [ Configuraci√≥n avanzada](https://playwright.dev/docs/test-configuration)
- [ Mejores pr√°cticas](https://playwright.dev/docs/best-practices)